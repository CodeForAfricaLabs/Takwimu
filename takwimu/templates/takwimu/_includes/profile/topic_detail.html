{% load staticfiles wagtailcore_tags %}

<div class="container-fluid data-topic-container py-4" id="{{ topic.value.title|slugify }}">
  <div class="container py-5">
    <div class="row">
      <!-- Left navigation of all indicators-->
      <div class="col-3 dataindicators-nav">
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist"
             aria-orientation="vertical">
          {% for indicator in topic.value.indicators %}
            
            <a class="nav-link pl-5 py-3 d-flex align-items-center {% if forloop.first %} active show {% endif %}"
               id="{{ indicator.id }}-tab-btn"
               data-toggle="pill" href="#{{ indicator.id }}-tab"
               role="tab" aria-controls="{{ indicator.id }}-tab"
                {% if forloop.first %} aria-selected="true" {% endif %}
               aria-selected="false">
              <i class="fas fa-eye fa-fw"></i>
              {{ indicator.value.title }}
            </a>

            {% if not forloop.last %}
              <hr class="mx-3 my-0" style="border-color: rgba(255, 255, 255, 0.2);"/>
            {% endif %}
          {% endfor %}
        </div>
        <!-- TODO: Integrate with Zendesk -->
        <div class="row pt-5 pb-5 text-dark">
          {% if page.content_type.model == "profilesectionpage" %}
            <p class=" pl-3">Add your voice to the discussion
              of {{ page.get_parent.title }}'s development context </p>
          {% else %}
            <p class=" pl-3">Add your voice to the discussion
              of {{ page.title }}'s development context </p>
          {% endif %}
          <a class="pl-3 font-weight-bold" href="{{ settings.takwimu.SupportSetting.zendesk }}" target="_blank" rel="noopener"
             style="text-decoration: none;">
            <span class="mr-1"><i class="fas fa-comments fa-lg"></i></span> Have
            your say</a>
        </div> <!-- /row pt-5 pb-5 text-dark -->
      </div>  <!-- /.col-3 -->

      <!-- The Main Stage -->
      <div class="col-9 topic topic-{{ topic.value.title|slugify }}">
        <h1>{{ topic.value.title }}</h1>
        <div class="text-dark">
          {{ topic.value.summary }}
          <div class="collapse mt-2" id="collapse-{{ topic.value.title|slugify }}">
          {% include_block topic.value.body %}
          </div>
          <button class="btn btn-link font-weight-bold px-0 read-more d-inline-block" type="button"
                  data-toggle="collapse" data-target="#collapse-{{ topic.value.title|slugify }}"
                  aria-expanded="false" aria-controls="collapse-{{ topic.value.title|slugify }}"
                  style="" onclick="javascript:$(this).toggleClass('active')">
          <!-- "Show More: inserted by CSS for easy toggle -->
          </button>
        </div>
        <div class="indicators-container">
          {% for indicator in topic.value.indicators %}
            <div class="tab-pane fade {% if forloop.first %} active show {% endif %}"
                id="{{ indicator.id }}-tab" role="tabpanel"
                aria-labelledby="{{ indicator.id }}-tab-panel">
            {% include 'takwimu/_includes/dataview/indicator.html' with indicator=indicator %}
            </div>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>
</div><!-- container fluid -->

<style>
  .dataindicators-nav .nav-pills {
    background-color: #1f6cc6;
  }

  .dataindicators-nav .nav-link {
    color: #f0f0f0;
  }

  .dataindicators-nav .nav-link:hover {
    color: #f0f0f0;;
  }

  .dataindicators-nav .nav-link .fa-eye {
    display: none;
    margin-left: -2em;
    position: absolute;
  }

  .dataindicators-nav .nav-link[aria-selected=true] .fa-eye {
    display: inline;
  }

  .dataindicators-nav .nav-pills .nav-link.active, .dataindicators-nav .nav-pills .show > .nav-link {
    background-color: transparent;
    font-weight: 500;
  }

  .topic .btn.read-more::after {
    content: "Show More \00bb";
  }

  .topic .btn.read-more.active::after {
    content: "Show Less \00ab"
  }

  .data-topic-container:nth-of-type(odd) {
    background: #f9f9f9;
  }

  .data-topic-container:nth-of-type(even) {
    background: #f4f4f4;
  }

  .topic .tab-content .tab-content {
    background: #ffffff;
  }

  .topic > h1 {
    font-size: 55px;
  }

  .topic h5 {
    font-size: 25px;
  }

  .topic .btn-group .btn {
    border-radius: 2px;
    color: #1a1a1a;
    background: #ffffff;
    border-color: #f4f4f4;
    box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.16);
  }

   /* Consistency tab active state for topic details */
   .indicators-container .nav-tabs .nav-item .nav-link {
    font-size: 14px;
    border-radius: 0;
  }
  .indicators-container .nav-tabs .nav-item.show .nav-link, 
  .indicators-container .nav-tabs .nav-link.active {
    font-weight: bold;
  }
</style>
