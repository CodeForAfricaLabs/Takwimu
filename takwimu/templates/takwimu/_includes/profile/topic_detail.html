{% load staticfiles wagtailcore_tags %}

<div class="container-fluid data-topic-container py-4" id="{{ topic.value.title|slugify }}">
  <div class="container py-5">
    <div class="row">
      <!-- Left navigation of all indicators-->
      <div class="col-4 dataindicators-nav sticky-top d-table" style="top: 100px;">
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist"
             aria-orientation="vertical">
          {% for indicator in topic.value.indicators %}
            
            <a class="nav-link pl-5 py-3 d-flex align-items-center {% if forloop.first %} active show {% endif %}"
               id="{{ indicator.id }}-tab-btn"
               data-toggle="pill" href="#{{ indicator.id }}-tab"
               role="tab" aria-controls="{{ indicator.id }}-tab"
                {% if forloop.first %} aria-selected="true" {% endif %}
               aria-selected="false">
              <i class="fas fa-eye fa-fw"></i>
              {{ indicator.value.title }}
            </a>

            {% if not forloop.last %}
              <hr class="mx-3 my-0" style="opacity: 0.37; border-color: rgba(151, 151, 151, 0.58);"/>
            {% endif %}
          {% endfor %}
        </div>
        <!-- TODO: Integrate with Zendesk -->
        <div class="row pt-5 pb-5 text-dark">
          {% if page.content_type.model == "profilesectionpage" %}
            <p class=" pl-3">Add your voice to the discussion
              of {{ page.get_parent.title }}'s development context </p>
          {% else %}
            <p class=" pl-3">Add your voice to the discussion
              of {{ page.title }}'s development context </p>
          {% endif %}
          <a class="pl-3 font-weight-bold" href="{{ settings.takwimu.SupportSetting.zendesk }}" target="_blank" rel="noopener"
             style="text-decoration: none;">
            <span class="mr-1"><i class="fas fa-comments fa-lg"></i></span> Have
            your say</a>
        </div> <!-- /row pt-5 pb-5 text-dark -->
      </div>  <!-- /.col-3 -->

      <!-- The Main Stage -->
      <div class="col-8 topic topic-{{ topic.value.title|slugify }}">
        <h1>{{ topic.value.title }}</h1>
        <div class="text-dark">
          {{ topic.value.summary }}
          <div class="collapse mt-2" id="collapse-{{ topic.value.title|slugify }}">
          {% include_block topic.value.body %}
          </div>
          <button class="btn btn-link font-weight-bold px-0 read-more d-inline-block" type="button"
                  data-toggle="collapse" data-target="#collapse-{{ topic.value.title|slugify }}"
                  aria-expanded="false" aria-controls="collapse-{{ topic.value.title|slugify }}"
                  style="" onclick="javascript:$(this).toggleClass('active')">
          <!-- "Show More: inserted by CSS for easy toggle -->
          </button>
        </div>
        <div class="indicators-container">
          {% for indicator in topic.value.indicators %}
            <div class="tab-pane fade {% if forloop.first %} active show {% endif %}"
                id="{{ indicator.id }}-tab" role="tabpanel"
                aria-labelledby="{{ indicator.id }}-tab-panel">
            {% include 'takwimu/_includes/dataview/indicator.html' with indicator=indicator %}
            </div>
          {% endfor %}
        </div>
        <!-- Indicator pagination -->
        <div class="container py-2 indicator-pagination">
            <div class="row d-flex justify-content-center my-3">
              <ol class="nav" role="tablist">
                {% for indicator in topic.value.indicators %}
                  <a class="nav-link p-1 d-flex align-items-center {% if forloop.first %} active show {% endif %}" 
                    id="{{ indicator.id }}-tab-btn"
                    data-toggle="pill" href="#{{ indicator.id }}-tab"
                    aria-controls="{{ indicator.id }}-tab"
                    {% if forloop.first %} aria-selected="true" {% endif %} role="tab" aria-selected="false">
                      <i class="fas fa-circle p-1"></i>
                  </a>
                {% endfor %}
              </ol>
            </div>
            <div class="row d-flex justify-content-around align-items-center my-3 nav" role="tablist">
                <a href="#" class="btn btn-primary border-0 nav-link prev-indicator col-4" data-toggle="pill" role="tab">
                  <span class="fas fa-angle-double-left position-absolute my-auto" 
                    style="left: 5%; top:0; bottom: 0; font-size: 10px;"></span>
                  <span class="prev font-weight-bold text-uppercase text-truncate d-block px-1" data-toggle="tooltip"
                    data-placement="bottom" style="font-size:14px; overflow: hidden;text-overflow: ellipsis;">Previous</span>
                </a>
                <span style="height: 47px; opacity: 0.3; border: solid 1px #979797;"></span>
                <a href="#" class="btn btn-primary border-0 nav-link next-indicator col-4" data-toggle="pill" role="tab">
                  <span class="next font-weight-bold text-uppercase text-truncate d-block px-1" data-toggle="tooltip"
                    data-placement="bottom" style="font-size: 14px; overflow: hidden;text-overflow: ellipsis;">Next</span>
                  <span class="fas fa-angle-double-right position-absolute my-auto" 
                    style="right: 5%; top: 0; bottom: 0; font-size: 10px;"></span>
                </a>
            </div>
        </div>
      </div>
    </div>
  </div>
</div><!-- container fluid -->
