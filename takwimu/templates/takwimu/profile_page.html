{% extends 'takwimu/_layouts/page.html' %}

{% block content %}

  {% include 'takwimu/_includes/profile/hero.html' %}

  {# Loads all the topics #}
  {% for topic in page.body %}
      {% include 'takwimu/_includes/profile/topic_detail.html' %}
  {% endfor %}

  <!-- <hr/> -->

  {% include 'takwimu/_includes/profile/sections_list.html' %}

  {% include 'takwimu/_includes/sections/support-services/button.html' %}

  {% include 'takwimu/_includes/sections/stories/index.html' %}

  <!-- Country profile country select -->
  {% include 'takwimu/_includes/sections/explore/_index.html' with extra_css_class="grayscale" %}

  {% include 'takwimu/_includes/sections/updates.html' %}

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Handling multiple IDS
      $(".data-topic-container").each(function () {
        // topicIds.push(this.id);
        var topic_id = this.id;

        var active_indicator = $("#" + topic_id + " .dataindicators-nav .nav-link.active"),
          prev_indicator = active_indicator.prev().prev().attr("id"),
          next_indicator = active_indicator.next().next().attr("id"),
          _prev = active_indicator.prev().prev().text(),
          _next = active_indicator.next().next().text();

        console.log(prev_indicator);

        $(".prev-indicator").find(".prev").html(_prev);
        $(".prev-indicator").attr({
          id: prev_indicator,
          href: "#" + prev_indicator,
          "aria-controls": prev_indicator
        });

        $(".next-indicator").find(".next").html(_next);
        $(".next-indicator").attr({
          id: next_indicator,
          href: "#" + next_indicator,
          "aria-controls": next_indicator
        });

        $("#" + topic_id + " .dataindicators-nav .nav-link").click(function () {
          prev_indicator = $(this).prev().prev().attr("id");
          next_indicator = $(this).next().next().attr("id");
          _next = $(this).next().next().text();
          _prev = $(this).prev().prev().text();

          $(".prev-indicator").find(".prev").html(_prev);
          $(".prev-indicator").attr({
            id: prev_indicator,
            href: "#" + prev_indicator,
            "aria-controls": prev_indicator
          });

          $(".next-indicator").find(".next").html(_next);
          $(".next-indicator").attr({
            id: next_indicator,
            href: "#" + next_indicator,
            "aria-controls": next_indicator
          });
        });
      });
    });
  </script>
{% endblock %}