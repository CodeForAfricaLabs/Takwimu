{% extends 'takwimu/_layouts/page.html' %}

{% block content %}

  {% include 'takwimu/_includes/profile/hero.html' %}

  {# Loads all the topics #}
  {% for topic in page.body %}
      {% include 'takwimu/_includes/profile/topic_detail.html' %}
  {% endfor %}

  <!-- <hr/> -->

  {% include 'takwimu/_includes/profile/sections_list.html' %}

  {% include 'takwimu/_includes/sections/support-services/button.html' %}

  {% include 'takwimu/_includes/sections/stories/index.html' %}

  <!-- Country profile country select -->
  {% include 'takwimu/_includes/sections/explore/_index.html' with extra_css_class="grayscale" %}

  {% include 'takwimu/_includes/sections/updates.html' %}

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Sync selected tabs to reflect on the indicator pagination
      // Collect data-topic-container IDS
      $(".data-topic-container").each(function () {
        // Topic id
        var topic_id = this.id,
            indicators_tabs = "#" + topic_id + " .dataindicators-nav .nav-link, #" + topic_id +
            " .indicator-pagination .nav-link";
        
        // Tabs Event
        $(indicators_tabs).on('shown.bs.tab', function (e) {
          // newly activated tab
          var active_tab = e.target;
          // previous active tab
          var previous_tab = e.relatedTarget;

          //set all nav tabs to inactive
          $(indicators_tabs).removeClass("active").attr("aria-selected", false);
          
          // Match indicator navigation tab with the current active tab
          var href = active_tab.getAttribute('href'),
              active_dataindicator = "#" + topic_id + " .dataindicators-nav a[href='" + href + "']",
              active_pagination_indicator = "#" + topic_id + " .indicator-pagination a[href='" + href + "']";
          
          //Get all nav tabs matching the href and set to active
          $(active_pagination_indicator).addClass("active").attr("aria-selected", true);
          $(active_dataindicator).addClass("active").addClass("active").attr("aria-selected", true);

        });
      });
    });
  </script>
{% endblock %}